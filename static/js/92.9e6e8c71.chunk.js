webpackJsonp([92],{1319:function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function n(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=(r(227),r(228)),i=(r(138),r(139)),u=(r(167),r(168)),m=r(0),E=r.n(m),o=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=u.a.Link,b=function(e){function t(){var e,r,n,c;a(this,t);for(var i=arguments.length,u=Array(i),m=0;m<i;m++)u[m]=arguments[m];return r=n=l(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.s="{",c=r,l(n,c)}return n(t,e),o(t,[{key:"render",value:function(){return E.a.createElement("div",null,E.a.createElement(c.a,null,E.a.createElement(i.a,{span:19},E.a.createElement("h3",{id:"next()\u65f6\u629b\u51faConcurrentModificationException"},E.a.createElement("a",{href:"javascript:void(0)",class:"anchor"},"next()\u65f6\u629b\u51faConcurrentModificationException")),E.a.createElement("p",null,"\u8fd9\u4e00\u6bb5\u4ee3\u7801:"),E.a.createElement("pre",null,E.a.createElement("code",null,"    public static void test1() ",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0ArrayList<Integer>\xa0arrayList\xa0=\xa0new\xa0ArrayList<>();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0for\xa0(int\xa0i\xa0=\xa00;\xa0i\xa0<\xa020;\xa0i++)\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0arrayList.add(Integer.valueOf(i));",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0//\xa0\u590d\u73b0\u65b9\u6cd5\u4e00",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Iterator<Integer>\xa0iterator\xa0=\xa0arrayList.iterator();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0while\xa0(iterator.hasNext())\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Integer\xa0integer\xa0=\xa0iterator.next();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0if\xa0(integer.intValue()\xa0==\xa05)\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0arrayList.remove(integer);",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0}",E.a.createElement("br",null))),E.a.createElement("p",null,"\u65b9\u6cd5\u4e00\u4e2d\u4f7f\u7528Iterator\u904d\u5386ArrayList\uff0c \u629b\u51fa\u5f02\u5e38\u7684\u662fiterator.next()\u3002\u770b\u4e0bArrayList.next()\u65b9\u6cd5\u5b9e\u73b0\u6e90\u7801:"),E.a.createElement("pre",null,E.a.createElement("code",null,"       public boolean hasNext() ",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0return\xa0cursor\xa0!=\xa0size;",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),'\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0@SuppressWarnings("unchecked")',E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0public\xa0E\xa0next()\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0checkForComodification();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0int\xa0i\xa0=\xa0cursor;",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0if\xa0(i\xa0>=\xa0size)",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0throw\xa0new\xa0NoSuchElementException();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Object[]\xa0elementData\xa0=\xa0ArrayList.this.elementData;",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0if\xa0(i\xa0>=\xa0elementData.length)",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0throw\xa0new\xa0ConcurrentModificationException();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0cursor\xa0=\xa0i\xa0+\xa01;",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0return\xa0(E)\xa0elementData[lastRet\xa0=\xa0i];",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0final\xa0void\xa0checkForComodification()\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0if\xa0(modCount\xa0!=\xa0expectedModCount)",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0throw\xa0new\xa0ConcurrentModificationException();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null))),E.a.createElement("p",null,"\u5728next\u65b9\u6cd5\u4e2d\u9996\u5148\u8c03\u7528\u4e86checkForComodification\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u4f1a\u5224\u65admodCount\u662f\u5426\u7b49\u4e8eexpectedModCount\uff0c\u4e0d\u7b49\u4e8e\u5c31\u4f1a\u629b\u51fajava.util.ConcurrentModificationExcepiton\u5f02\u5e38\u3002"),E.a.createElement("p",null,"\u6211\u4eec\u63a5\u4e0b\u6765\u8ddf\u8e2a\u770b\u4e00\u4e0bmodCount\u548cexpectedModCount\u7684\u8d4b\u503c\u548c\u4fee\u6539\u3002"),E.a.createElement("p",null,"modCount\u662fArrayList\u7684\u4e00\u4e2a\u5c5e\u6027\uff0c\u7ee7\u627f\u81ea\u62bd\u8c61\u7c7bAbstractList\uff0c\u7528\u4e8e\u8868\u793aArrayList\u5bf9\u8c61\u88ab\u4fee\u6539\u6b21\u6570\u3002"),E.a.createElement("p",null,"\u6574\u4e2aArrayList\u4e2d\u4fee\u6539modCount\u7684\u65b9\u6cd5\u6bd4\u8f83\u591a\uff0c\u6709add\u3001remove\u3001clear\u3001ensureCapacityInternal\u7b49\uff0c\u51e1\u662f\u8bbe\u8ba1\u5230ArrayList\u5bf9\u8c61\u4fee\u6539\u7684\u90fd\u4f1a\u81ea\u589emodCount\u5c5e\u6027\u3002"),E.a.createElement("p",null,"\u5728\u521b\u5efaListIterator\u7684\u65f6\u5019\u4f1a\u5c06modCount\u8d4b\u503c\u7ed9expectedModCount\uff0c\u5728\u904d\u5386ArrayList\u8fc7\u7a0b\u4e2d\uff0c\u6ca1\u6709\u5176\u4ed6\u5730\u65b9\u53ef\u4ee5\u8bbe\u7f6eexpectedModCount\u4e86\uff0c\u56e0\u6b64\u904d\u5386\u8fc7\u7a0b\u4e2dexpectedModCount\u4f1a\u4e00\u76f4\u4fdd\u6301\u521d\u59cb\u503c20\uff08\u8c03\u7528add\u65b9\u6cd5\u6dfb\u52a0\u4e8620\u4e2a\u5143\u7d20\uff0c\u4fee\u6539\u4e8620\u6b21\uff09\u3002"),E.a.createElement("p",null,"\u904d\u5386\u7684\u65f6\u5019\u662f\u4e0d\u4f1a\u89e6\u53d1modCount\u81ea\u589e\u7684\uff0c\u4f46\u662f\u904d\u5386\u5230integer.intValue() == 5\u7684\u65f6\u5019\uff0c\u6267\u884c\u4e86\u4e00\u6b21arrayList.remove(integer)\uff0c\u8fd9\u884c\u4ee3\u7801\u6267\u884c\u540emodCount++\u53d8\u4e3a\u4e8621\uff0c\u4f46\u6b64\u65f6\u7684expectedModCount\u4ecd\u7136\u4e3a20\u3002"),E.a.createElement("p",null,"\u5728\u6267\u884cnext\u65b9\u6cd5\u65f6\uff0c\u9047\u5230modCount != expectedModCount\u65b9\u6cd5\uff0c\u5bfc\u81f4\u629b\u51fa\u5f02\u5e38java.util.ConcurrentModificationException\u3002"),E.a.createElement("h3",{id:"for\u5faa\u73af \u65f6\u629b\u51faConcurrentModificationException"},E.a.createElement("a",{href:"javascript:void(0)",class:"anchor"},"for\u5faa\u73af \u65f6\u629b\u51faConcurrentModificationException")),E.a.createElement("pre",null,E.a.createElement("code",null,"    public static void main(String... s) throws InterruptedException ",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0List<User>\xa0list1\xa0=\xa0new\xa0ArrayList<User>();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0for\xa0(int\xa0x\xa0=0;x<15;x++)\xa0",this.s,E.a.createElement("br",null),'\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0User\xa0user2\xa0=\xa0new\xa0User(x+"x",\xa01l);',E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0if\xa0(list1.isEmpty())\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0list1.add(user2);",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}\xa0else\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0for\xa0(User\xa0ecity\xa0:\xa0list1)\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0if\xa0(user2.getName().equals(ecity.getName()))\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0ecity.setCc(ecity.getCc()\xa0+\xa01);",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}else\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0list1.add(user2);",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0public\xa0class\xa0User\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0private\xa0\xa0String\xa0name;",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0private\xa0Long\xa0id;",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0private\xa0Long\xa0cc\xa0=1l;",E.a.createElement("br",null))),E.a.createElement("p",null,"\u903b\u8f91\u4e0a\u597d\u50cf\u6ca1\u6709\u4ec0\u4e48\u95ee\u9898\uff0c\u4f46\u662f\uff1a"),E.a.createElement("pre",null,E.a.createElement("code",null,'Exception in thread "main" java.util.ConcurrentModificationException',E.a.createElement("br",null),"at\xa0java.util.ArrayList$Itr.checkForComodification(ArrayList.java:907)",E.a.createElement("br",null),"at\xa0java.util.ArrayList$Itr.next(ArrayList.java:857)",E.a.createElement("br",null),"at\xa0org.kx.doe.care.ConcurrentExceptionTest.main(ConcurrentExceptionTest.java:18)",E.a.createElement("br",null),"for\xa0(User\xa0ecity\xa0:\xa0list1)\xa0",this.s,"...",E.a.createElement("br",null))),E.a.createElement("p",null,"\u770b\u5230\u4e86\u8fd9\u91cc\u8fd8\u662f\u8c03\u7528\u4e86next\u65b9\u6cd5\uff0c\u6240\u4ee5\u5728for\u5faa\u73af\u5185\u8981\u505aadd\u64cd\u4f5c\u662f\u4e0d\u5141\u8bb8\u7684\u3002"),E.a.createElement("p",null,"\xa0"),E.a.createElement("p",null,"\u4f46\u662f\uff1a"),E.a.createElement("pre",null,E.a.createElement("code",null,"public static void test7() ",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0List<User>\xa0list1\xa0=\xa0new\xa0ArrayList<User>();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0for\xa0(int\xa0x\xa0=\xa00;\xa0x\xa0<\xa015;\xa0x++)\xa0",this.s,E.a.createElement("br",null),'\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0User\xa0user2\xa0=\xa0new\xa0User(x\xa0+\xa0"x",\xa01l);',E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0if\xa0(list1.isEmpty())\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0list1.add(user2);",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}\xa0else\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0for\xa0(int\xa0xd=0;xd<\xa0list1.size()\xa0;\xa0xd\xa0++)\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0User\xa0ecity\xa0=\xa0\xa0list1.get(xd);",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0if\xa0(user2.getName().equals(ecity.getName()))\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0ecity.setCc(ecity.getCc()\xa0+\xa01);",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}\xa0else\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0list1.add(user2);",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"}",E.a.createElement("br",null))),E.a.createElement("p",null,"\u8fd9\u6837\u662f\u6ca1\u6709\u95ee\u9898\u7684\uff0c\u552f\u4e00\u7684\u533a\u522b\u5728\u4e8e\u8fed\u4ee3\u4f7f\u7528\u7684\u65b9\u5f0f\u4e0d\u540c\uff0c for (User ecity : list1)\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u81ea\u52a8\u521b\u5efaIterator\uff0c\u6240\u4ee5\u5728next\u8c03\u7528\u7684\u65f6\u5019\u4f1a\u629b\u51faConcurrentModificationException\u5f02\u5e38\u3002"),E.a.createElement("p",null,"\xa0"),E.a.createElement("h3",{id:"\u4e3a\u4ec0\u4e48\u5012\u6392\u5220\u9664\u662f\u53ef\u4ee5\u7684\uff1f"},E.a.createElement("a",{href:"javascript:void(0)",class:"anchor"},"\u4e3a\u4ec0\u4e48\u5012\u6392\u5220\u9664\u662f\u53ef\u4ee5\u7684\uff1f")),E.a.createElement("p",null,"\u663e\u7136\u4f7f\u7528Iterator <Integer> iterator = arrayList.iterator();\u6216 for (User ecity : list1) \u8fd9\u4e24\u79cd\u65b9\u5f0f\u8fdb\u884c\u64cd\u4f5c\u90fd\u4f1a\u629b\u51faConcurrentModificationException\u5f02\u5e38\u3002\u901a\u8fc7\u4e0b\u6807\u8fdb\u884c\u64cd\u4f5c\u662f\u53ef\u4ee5\u7684\uff0c\u5047\u5982\u6211\u4eec\u5148\u6b63\u5e8f\u5220\u9664\u4f1a\u600e\u4e48\u6837\u5462\uff1f"),E.a.createElement("pre",null,E.a.createElement("code",null,"    public static void test4() ",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0ArrayList<Integer>\xa0arrayList\xa0=\xa0new\xa0ArrayList<>();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0for\xa0(int\xa0i\xa0=\xa00;\xa0i\xa0<\xa020;\xa0i++)\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0arrayList.add(Integer.valueOf(i));",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0for(int\xa0i\xa0=\xa00;\xa0i\xa0<\xa020;\xa0i++)",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0if(i\xa0%2\xa0==\xa00)",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0arrayList.remove(i);",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0for\xa0(int\xa0i\xa0=\xa00;\xa0i\xa0<\xa0arrayList.size();\xa0i++)\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0System.out.println(arrayList.get(i));",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),'Exception\xa0in\xa0thread\xa0"main"\xa0java.lang.IndexOutOfBoundsException:\xa0Index:\xa014,\xa0Size:\xa013',E.a.createElement("br",null),"at\xa0java.util.ArrayList.rangeCheck(ArrayList.java:657)",E.a.createElement("br",null),"at\xa0java.util.ArrayList.remove(ArrayList.java:496)",E.a.createElement("br",null),"at\xa0org.kx.doe.care.ConcurrentExceptionTest.test4(ConcurrentExceptionTest.java:98)",E.a.createElement("br",null),"at\xa0org.kx.doe.care.ConcurrentExceptionTest.main(ConcurrentExceptionTest.java:13)\xa0\xa0\xa0\xa0",E.a.createElement("br",null))),E.a.createElement("p",null,"\u53ef\u4ee5\u770b\u51fa \u8d85\u51fa\u6570\u7ec4\u957f\u5ea6\u4e86\uff0c\u56e0\u4e3a\u4f60\u5220\u9664\u4e86\u5143\u7d20\uff0c\u4f46\u662f\u672a\u6539\u53d8\u8fed\u4ee3\u7684\u4e0b\u6807\uff0c\u8fd9\u6837\u5f53\u8fed\u4ee3\u5230\u6700\u540e\u4e00\u4e2a\u7684\u65f6\u5019\u5c31\u4f1a\u629b\u5f02\u5e38\u3002"),E.a.createElement("p",null,"\u76f8\u5f53\u4e8e\u5728for\u5faa\u73af\u8fc7\u7a0b\u4e2d\uff0clist\u7684\u957f\u5ea6\u771f\u5b9e\u51cf\u5c11\u4e86\uff0c\u800c\u4f60\u8fd8\u60f3\u8bbf\u95ee\u4e0b\u6807\u4e3a14\u7684\u5143\u7d20\uff0c\u6545\u629b\u51fa\u8d85\u51falist\u957f\u5ea6\u5f02\u5e38\u3002"),E.a.createElement("p",null,"\u5982\u679c\u6539\u4e3a\u5012\u6392\u5220\u9664\u5462\uff1f"),E.a.createElement("pre",null,E.a.createElement("code",null,"    public static void test3() ",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0ArrayList<Integer>\xa0arrayList\xa0=\xa0new\xa0ArrayList<>();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0for\xa0(int\xa0i\xa0=\xa00;\xa0i\xa0<\xa020;\xa0i++)\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0arrayList.add(Integer.valueOf(i));",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0for(int\xa0i\xa0=19;i>=0;i--)",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0if(i\xa0%2\xa0==\xa00)",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0arrayList.remove(i);",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0System.out.println(arrayList.get(i));",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"19",E.a.createElement("br",null),"19",E.a.createElement("br",null),"17",E.a.createElement("br",null),"17",E.a.createElement("br",null),"15",E.a.createElement("br",null),"15",E.a.createElement("br",null),"13",E.a.createElement("br",null),"13",E.a.createElement("br",null),"11",E.a.createElement("br",null),"11",E.a.createElement("br",null),"9",E.a.createElement("br",null),"9",E.a.createElement("br",null),"7",E.a.createElement("br",null),"7",E.a.createElement("br",null),"5",E.a.createElement("br",null),"5",E.a.createElement("br",null),"3",E.a.createElement("br",null),"3",E.a.createElement("br",null),"1",E.a.createElement("br",null),"1",E.a.createElement("br",null))),E.a.createElement("p",null,"\u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u5f88\u597d\u7684\u8fd0\u884c\uff0c\u5206\u6790\u4e00\u4e0b\uff1a"),E.a.createElement("p",null,"\u76f8\u5f53\u4e8e\u5728\u5220\u9664\u5143\u7d20\u7684\u540c\u65f6\uff0clist\u957f\u5ea6\u51cf\u5c111\uff0c\u800c\u4f60\u7684\u7d22\u5f15\u4e5f\u51cf\u5c111;\u5047\u5982i=18\u7684\u4e0b\u6807\u5143\u7d20\u88ab\u5220\u9664\u4e86\uff0clist\u7684\u957f\u5ea6\u53d8\u4e3a19\uff0cnext(i)= 17\uff0c\u5f53\u6267\u884csout(list.get(i)),\u6b64\u65f6i=18\uff0c\u6b63\u597dlist.get(19)\u548c\u524d\u4e00\u6b21\u6253\u5370\u7684\u5143\u7d20\u662f\u540c\u4e00\u4e2a\u5143\u7d20\uff0c\u90fd\u4e3a19\u3002"),E.a.createElement("p",null,"\u6240\u4ee5\u770b\u5230\u7684\u5947\u6570\u6570\u5b57\u90fd\u6253\u5370\u4e862\u6b21\u3002"),E.a.createElement("p",null,"\xa0"),E.a.createElement("h3",{id:"ConcurrentModificationException\u600e\u4e48\u89e3\u51b3"},E.a.createElement("a",{href:"javascript:void(0)",class:"anchor"},"ConcurrentModificationException\u600e\u4e48\u89e3\u51b3")),E.a.createElement("h4",{id:"\u5355\u7ebf\u7a0b\u4e2d\u7684\u89e3\u51b3\u65b9\u6848"},E.a.createElement("a",{href:"javascript:void(0)",class:"anchor"},"\u5355\u7ebf\u7a0b\u4e2d\u7684\u89e3\u51b3\u65b9\u6848")),E.a.createElement("pre",null,E.a.createElement("code",null,"    public static void test8() ",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0ArrayList<Integer>\xa0arrayList\xa0=\xa0new\xa0ArrayList<>();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0for\xa0(int\xa0i\xa0=\xa00;\xa0i\xa0<\xa020;\xa0i++)\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0arrayList.add(Integer.valueOf(i));",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0//\xa0\u590d\u73b0\u65b9\u6cd5\u4e00",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Iterator<Integer>\xa0iterator\xa0=\xa0arrayList.iterator();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0while\xa0(iterator.hasNext())\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Integer\xa0integer\xa0=\xa0iterator.next();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0if\xa0(integer.intValue()\xa0==\xa05)\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0iterator.remove();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0}",E.a.createElement("br",null))),E.a.createElement("p",null,"\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\u4f7f\u7528\uff0citerator.remove() \u800c\u4e0d\u662f\u4f7f\u7528arrayList.remove(integer);\u5c31\u53ef\u4ee5\u5b9e\u73b0\u5220\u9664\u7684\u64cd\u4f5c\uff0c\u56e0\u4e3aiterator.remove()\u662f\u8c03\u7528iterator\u7684remove\u800c\u4e0d\u662farrayList.remove\uff1b\u4f7f\u7528iterator.remove()\u4e2d\u4f1a\u91cd\u65b0\u8fdb\u884c"),E.a.createElement("pre",null,E.a.createElement("code",null," ArrayList.this.remove(lastRet);",E.a.createElement("br",null),"expectedModCount\xa0=\xa0ArrayList.this.modCount;",E.a.createElement("br",null))),E.a.createElement("p",null,"\u5728iterator.remove()\u65b9\u6cd5\u4e2d\uff0c\u540c\u6837\u8c03\u7528\u4e86ArrayList\u81ea\u8eab\u7684remove\u65b9\u6cd5\uff0c\u4f46\u662f\u8c03\u7528\u5b8c\u4e4b\u540e\u5e76\u975e\u5c31return\u4e86\uff0c\u800c\u662fexpectedModCount = modCount\u91cd\u7f6e\u4e86expectedModCount\u503c\uff0c\u4f7f\u4e8c\u8005\u7684\u503c\u7ee7\u7eed\u4fdd\u6301\u76f8\u7b49\u3002"),E.a.createElement("p",null,"\u4f7f\u7528for (User ecity : list1)\u662f\u884c\u4e0d\u901a\u7684\uff0c\u56e0\u4e3a\u6ca1\u6709\u62ff\u5230 iterator\u5bf9\u8c61\u3002"),E.a.createElement("p",null,"\xa0"),E.a.createElement("h4",{id:"\u591a\u7ebf\u7a0b\u7684\u89e3\u51b3\u65b9\u6848"},E.a.createElement("a",{href:"javascript:void(0)",class:"anchor"},"\u591a\u7ebf\u7a0b\u7684\u89e3\u51b3\u65b9\u6848")),E.a.createElement("p",null,"1\u3001\u52a0\u540c\u6b65\u9501"),E.a.createElement("p",null,"2\u3001CopyOnWriteArrayList"),E.a.createElement("p",null,"\xa0"),E.a.createElement("h3",{id:"CopyOnWriteArrayList\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u5417\uff1f"},E.a.createElement("a",{href:"javascript:void(0)",class:"anchor"},"CopyOnWriteArrayList\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u5417\uff1f")),E.a.createElement("p",null,"\u524d\u9762\u63d0\u5230\u4f7f\u7528CopyOnWriteArrayList\u6765\u89e3\u51b3\u591a\u7ebf\u7a0b\u94fe\u8868\u7684\u64cd\u4f5c\uff0c\u4f46\u662f\u770b\u4e86CopyOnWriteArrayList\u6e90\u7801\u540e\u53d1\u73b0\uff0c\u8fd8\u662f\u5b58\u5728\u95ee\u9898\u7684\uff1a"),E.a.createElement("pre",null,E.a.createElement("code",null,"public class CopyOnWriteArrayList<E>",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0implements\xa0List<E>,\xa0RandomAccess,\xa0Cloneable,\xa0java.io.Serializable\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0private\xa0transient\xa0volatile\xa0Object[]\xa0array;",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0final\xa0Object[]\xa0getArray()\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0return\xa0array;",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0final\xa0void\xa0setArray(Object[]\xa0a)\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0array\xa0=\xa0a;",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0public\xa0CopyOnWriteArrayList()\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0setArray(new\xa0Object[0]);",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0}",E.a.createElement("br",null))),E.a.createElement("p",null,"\u4f8b\uff1a"),E.a.createElement("pre",null,E.a.createElement("code",null,"public static void test9() ",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0final\xa0List<Integer>\xa0list\xa0=\xa0new\xa0CopyOnWriteArrayList<>();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0for\xa0(int\xa0i\xa0=\xa00;\xa0i\xa0<\xa020;\xa0i++)\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0list.add(Integer.valueOf(i));",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Thread\xa0thread1\xa0=\xa0new\xa0Thread(new\xa0Runnable()\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0@Override",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0public\xa0void\xa0run()\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0ListIterator<Integer>\xa0iterator\xa0=\xa0list.listIterator();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0while\xa0(iterator.hasNext())\xa0",this.s,E.a.createElement("br",null),'\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0System.out.println("thread1\xa0"\xa0+\xa0iterator.next().intValue());',E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0try\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Thread.sleep(1000);",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}\xa0catch\xa0(InterruptedException\xa0e)\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0e.printStackTrace();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0});",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Thread\xa0thread2\xa0=\xa0new\xa0Thread(new\xa0Runnable()\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0@Override",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0public\xa0void\xa0run()\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0for\xa0(Integer\xa0integer\xa0:\xa0list)\xa0",this.s,E.a.createElement("br",null),'\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0System.out.println("thread2\xa0"\xa0+\xa0integer.intValue());',E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0if\xa0(integer.intValue()\xa0==\xa05)\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0list.remove(integer);",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0for\xa0(Integer\xa0integer\xa0:\xa0list)\xa0",this.s,E.a.createElement("br",null),'\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0System.out.println("thread2\xa0again\xa0"\xa0+\xa0integer.intValue());',E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0});",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0thread1.start();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0thread2.start();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0thread1\xa00",E.a.createElement("br",null),"thread2\xa00",E.a.createElement("br",null),"thread2\xa01",E.a.createElement("br",null),"thread2\xa02",E.a.createElement("br",null),"thread2\xa03",E.a.createElement("br",null),"thread2\xa04",E.a.createElement("br",null),"thread2\xa05",E.a.createElement("br",null),"thread2\xa06",E.a.createElement("br",null),"thread2\xa07",E.a.createElement("br",null),"thread2\xa08",E.a.createElement("br",null),"thread2\xa09",E.a.createElement("br",null),"thread2\xa010",E.a.createElement("br",null),"thread2\xa011",E.a.createElement("br",null),"thread2\xa012",E.a.createElement("br",null),"thread2\xa013",E.a.createElement("br",null),"thread2\xa014",E.a.createElement("br",null),"thread2\xa015",E.a.createElement("br",null),"thread2\xa016",E.a.createElement("br",null),"thread2\xa017",E.a.createElement("br",null),"thread2\xa018",E.a.createElement("br",null),"thread2\xa019",E.a.createElement("br",null),"thread2\xa0again\xa00",E.a.createElement("br",null),"thread2\xa0again\xa01",E.a.createElement("br",null),"thread2\xa0again\xa02",E.a.createElement("br",null),"thread2\xa0again\xa03",E.a.createElement("br",null),"thread2\xa0again\xa04",E.a.createElement("br",null),"thread2\xa0again\xa06",E.a.createElement("br",null),"thread2\xa0again\xa07",E.a.createElement("br",null),"thread2\xa0again\xa08",E.a.createElement("br",null),"thread2\xa0again\xa09",E.a.createElement("br",null),"thread2\xa0again\xa010",E.a.createElement("br",null),"thread2\xa0again\xa011",E.a.createElement("br",null),"thread2\xa0again\xa012",E.a.createElement("br",null),"thread2\xa0again\xa013",E.a.createElement("br",null),"thread2\xa0again\xa014",E.a.createElement("br",null),"thread2\xa0again\xa015",E.a.createElement("br",null),"thread2\xa0again\xa016",E.a.createElement("br",null),"thread2\xa0again\xa017",E.a.createElement("br",null),"thread2\xa0again\xa018",E.a.createElement("br",null),"thread2\xa0again\xa019",E.a.createElement("br",null),"thread1\xa01",E.a.createElement("br",null),"thread1\xa02",E.a.createElement("br",null),"thread1\xa03",E.a.createElement("br",null),"thread1\xa04",E.a.createElement("br",null),"thread1\xa05",E.a.createElement("br",null),"thread1\xa06",E.a.createElement("br",null),"thread1\xa07",E.a.createElement("br",null),"thread1\xa08",E.a.createElement("br",null),"thread1\xa09",E.a.createElement("br",null),"thread1\xa010",E.a.createElement("br",null),"thread1\xa011",E.a.createElement("br",null),"thread1\xa012",E.a.createElement("br",null),"thread1\xa013",E.a.createElement("br",null),"thread1\xa014",E.a.createElement("br",null),"thread1\xa015",E.a.createElement("br",null),"thread1\xa016",E.a.createElement("br",null),"thread1\xa017",E.a.createElement("br",null),"thread1\xa018",E.a.createElement("br",null),"thread1\xa019",E.a.createElement("br",null))),E.a.createElement("p",null,"\u6211\u4eec\u5148\u5206\u6790thread2\u7684\u8f93\u51fa\u7ed3\u679c\uff0c\u7b2c\u4e00\u6b21\u904d\u5386\u5c064 5 6\u90fd\u8f93\u51fa\uff0c\u60c5\u7406\u4e4b\u4e2d\uff1b\u7b2c\u4e00\u6b21\u904d\u5386\u540e\u5220\u9664\u6389\u4e86\u4e00\u4e2a\u5143\u7d20\uff0c\u7b2c\u4e8c\u6b21\u904d\u5386\u8f93\u51fa4 6\uff0c\u7b26\u5408\u6211\u4eec\u7684\u9884\u671f\u3002"),E.a.createElement("p",null,"\u518d\u6765\u770b\u4e0bthread1\u7684\u8f93\u51fa\u7ed3\u679c\uff0c\u6709\u610f\u601d\u7684\u4e8b\u60c5\u6765\u4e86\uff0cthread1 \u4ecd\u7136\u8f93\u51fa\u4e864 5 6\uff0c\u4ec0\u4e48\u9b3c\uff1fthread1\u548cthread2\u90fd\u662f\u904d\u5386list\uff0clist\u5728thread1\u904d\u5386\u7b2c\u4e8c\u4e2a\u5143\u7d20\u7684\u65f6\u5019\u5c31\u5df2\u7ecf\u5220\u9664\u4e86\u4e00\u4e2a\u5143\u7d20\u4e86\uff0c\u4e3a\u5565\u8fd8\u80fd\u8f93\u51fa5\uff1f"),E.a.createElement("p",null,"CopyOnWriteArrayList\u672c\u8d28\u4e0a\u662f\u5bf9array\u6570\u7ec4\u7684\u4e00\u4e2a\u5c01\u88c5\uff0c\u4e00\u65e6CopyOnWriteArrayList\u5bf9\u8c61\u53d1\u751f\u4efb\u4f55\u7684\u4fee\u6539\u90fd\u4f1anew\u4e00\u4e2a\u65b0\u7684Object[]\u6570\u7ec4newElement\uff0c\u5728newElement\u6570\u7ec4\u4e0a\u6267\u884c\u4fee\u6539\u64cd\u4f5c\uff0c\u4fee\u6539\u5b8c\u6210\u540e\u5c06newElement\u8d4b\u503c\u7ed9array\u6570\u7ec4\uff08array=newElement\uff09\u3002"),E.a.createElement("p",null,"\u56e0\u4e3aarray\u662fvolatile\u7684\uff0c\u56e0\u6b64\u5b83\u7684\u4fee\u6539\u5bf9\u6240\u6709\u7ebf\u7a0b\u90fd\u53ef\u89c1\u3002"),E.a.createElement("p",null,"\xa0"),E.a.createElement("p",null,"\u4e86\u89e3\u4e86CopyOnWriteArrayList\u7684\u5b9e\u73b0\u601d\u8def\u4e4b\u540e\uff0c\u6211\u4eec\u518d\u6765\u5206\u6790\u4e0a\u9762\u4ee3\u7801test6\u4e3a\u4ec0\u4e48\u4f1a\u51fa\u73b0\u90a3\u6837\u7684\u8f93\u51fa\u7ed3\u679c\u3002\u5148\u6765\u770b\u4e0bthread2\u4e2d\u7528\u5230\u7684\u904d\u5386\u65b9\u5f0f\u7684\u6e90\u7801\uff1a"),E.a.createElement("pre",null,E.a.createElement("code",null,"public ListIterator<E> listIterator() ",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0return\xa0new\xa0COWIterator<E>(getArray(),\xa00);",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0static\xa0final\xa0class\xa0COWIterator<E>\xa0implements\xa0ListIterator<E>\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0 private\xa0final\xa0Object[]\xa0snapshot;",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0private\xa0int\xa0cursor;",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0private\xa0COWIterator(Object[]\xa0elements,\xa0int\xa0initialCursor)\xa0",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0cursor\xa0=\xa0initialCursor;",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0//\xa0\u521d\u59cb\u5316\u4e3a\u5f53\u524d\u6570\u7ec4",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0snapshot\xa0=\xa0elements;",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"...\xa0\xa0\xa0\xa0\xa0",E.a.createElement("br",null))),E.a.createElement("p",null,"\u4e0a\u9762\u770b\u5230snapshot \u8fd9\u4e2a\u5bf9\u8c61\u4e0d\u662f\u7ebf\u7a0b\u53ef\u89c1\u7684\u3002"),E.a.createElement("p",null,"\u518d\u770b\u4e0bthread1\u4e2d\u7528\u5230\u7684\u904d\u5386\u65b9\u5f0f\u7684\u6e90\u7801\uff1a"),E.a.createElement("pre",null,E.a.createElement("code",null," public void forEach(Consumer<? super E> action) ",this.s,E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0Object[]\xa0elements\xa0=\xa0getArray();",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0int\xa0len\xa0=\xa0elements.length;",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0for\xa0(int\xa0i\xa0=\xa00;\xa0i\xa0<\xa0len;\xa0++i)\xa0",this.s,E.a.createElement("br",null),'\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0@SuppressWarnings("unchecked")\xa0E\xa0e\xa0=\xa0(E)\xa0elements[i];',E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0action.accept(e);",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null),"\xa0\xa0\xa0\xa0\xa0}",E.a.createElement("br",null))),E.a.createElement("p",null,"\u8fd9\u4e24\u79cd\u904d\u5386\u65b9\u5f0f\u6709\u4e2a\u5171\u540c\u7684\u7279\u70b9\uff1a",E.a.createElement("strong",null,"\u90fd\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u5c06\u5f53\u524d\u6570\u7ec4\u4fdd\u5b58\u4e0b\u6765\u4e86\uff0c\u4e4b\u540e\u7684\u904d\u5386\u90fd\u5c06\u4f1a\u904d\u5386\u8fd9\u4e2a\u6570\u7ec4\uff0c\u800c\u4e0d\u7ba1array\u5982\u4f55\u53d8\u5316\u3002")),E.a.createElement("p",null,"\u6709\u4e86\u8fd9\u4e2a\u65f6\u95f4\u8282\u70b9\u8868\u5c31\u5f88\u6e05\u695a\u4e86\uff0cthread1\u548cthread2 start\u7684\u65f6\u5019\u90fd\u4f1a\u5c06A\u6570\u7ec4\u521d\u59cb\u5316\u7ed9\u81ea\u5df1\u7684\u4e34\u65f6\u53d8\u91cf\uff0c\u4e4b\u540e\u904d\u5386\u7684\u4e5f\u90fd\u662f\u8fd9\u4e2aA\u6570\u7ec4\uff0c\u800c\u4e0d\u7ba1CopyOnWriteArrayList\u4e2d\u7684array\u53d1\u751f\u4e86\u4ec0\u4e48\u53d8\u5316\u3002\u56e0\u6b64\u4e5f\u5c31\u89e3\u91ca\u4e86thread1\u5728thread2 remove\u6389\u4e00\u4e2a\u5143\u7d20\u4e4b\u540e\u4e3a\u4ec0\u4e48\u8fd8\u4f1a\u8f93\u51fa5\u4e86\u3002\u5728thread2\u4e2d\uff0c\u7b2c\u4e8c\u6b21\u904d\u5386\u521d\u59cb\u5316\u6570\u7ec4\u53d8\u6210\u4e86\u5f53\u524d\u7684array\uff0c\u4e5f\u5c31\u662f\u4fee\u6539\u540e\u7684B\uff0c\u56e0\u6b64\u4e0d\u4f1a\u6709Integer.valueOf(5)\u8fd9\u4e2a\u5143\u7d20\u4e86\u3002"),E.a.createElement("p",null,"\xa0"),E.a.createElement("p",null,"\u6b64\u5916CopyOnWriteArrayList\u4e2d\u7684ListIterator\u5b9e\u73b0\u662f\u4e0d\u652f\u6301remove\u3001add\u548cset\u64cd\u4f5c\u7684\uff0c\u4e00\u65e6\u8c03\u7528\u5c31\u4f1a\u629b\u51faUnsupportedOperationException\u5f02\u5e38\u3002"),E.a.createElement("p",null,"\xa0"),E.a.createElement("p",null,"\u6240\u4ee5\u9700\u8981\u591a\u7ebf\u7a0b\u4fee\u6539list\u65f6\uff0c\u90fd\u662f\u4e0d\u5b89\u5168\u7684\uff0c\u4e0d\u7ba1\u662f\u4f7f\u7528\u540c\u6b65\u5757\u8fd8\u662fCopyOnWriteArrayList\u3002\u8fd9\u91cc\u8bf4\u7684\u4e0d\u5b89\u5168\uff0c\u5373\u5305\u62ec\u6570\u636e\u4e00\u81f4\u95ee\u9898\uff0c\u4e5f\u5305\u62ec\u6570\u636e\u4e0b\u6807\u8d85\u51fa\u95ee\u9898\u3002"),E.a.createElement("p",null,"\xa0")),E.a.createElement(i.a,{span:1}),E.a.createElement(i.a,{span:4},E.a.createElement(u.a,{showInkInFixed:"true"},E.a.createElement(s,{href:"#next()\u65f6\u629b\u51faConcurrentModificationException",title:"next()\u65f6\u629b\u51faConcurrentModificationException"}),E.a.createElement(s,{href:"#for\u5faa\u73af \u65f6\u629b\u51faConcurrentModificationException",title:"for\u5faa\u73af \u65f6\u629b\u51faConcurrentModificationException"}),E.a.createElement(s,{href:"#\u4e3a\u4ec0\u4e48\u5012\u6392\u5220\u9664\u662f\u53ef\u4ee5\u7684\uff1f",title:"\u4e3a\u4ec0\u4e48\u5012\u6392\u5220\u9664\u662f\u53ef\u4ee5\u7684\uff1f"}),E.a.createElement(s,{href:"#ConcurrentModificationException\u600e\u4e48\u89e3\u51b3",title:"ConcurrentModificationException\u600e\u4e48\u89e3\u51b3"},E.a.createElement(s,{href:"#\u5355\u7ebf\u7a0b\u4e2d\u7684\u89e3\u51b3\u65b9\u6848",title:"\u5355\u7ebf\u7a0b\u4e2d\u7684\u89e3\u51b3\u65b9\u6848"}),E.a.createElement(s,{href:"#\u591a\u7ebf\u7a0b\u7684\u89e3\u51b3\u65b9\u6848",title:"\u591a\u7ebf\u7a0b\u7684\u89e3\u51b3\u65b9\u6848"})),E.a.createElement(s,{href:"#CopyOnWriteArrayList\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u5417\uff1f",title:"CopyOnWriteArrayList\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u5417\uff1f"})))))}}]),t}(m.Component);t.default=b}});
//# sourceMappingURL=92.9e6e8c71.chunk.js.map